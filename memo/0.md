# Javel.Parser

　小説の簡易書式をHTMLに変換するJavaScriptプログラム。

# 書式

HTML|Javel
----|----
`<p>`|２行以上の連続した改行があるとその前のテキストが`<p>`になる
`<br>`|１つだけの改行
`<h1>`|`# `のあとに続くテキストは`<h1>`になる
`<em>`|`《《ここ》》`のように書くと`ここ`に圏点がつく
`<ruby>`|`山田《やまだ》`、`｜OK《Okey》`のように書くとルビがつく

# 入出力

* UI
	* API（CDN, Library（各言語(C/C++,Rust,C#,Java,Python,JS,Node.js,...)））
	* CUI（WebApi, CLI）
	* GUI（WebApp, OS-GUI）
* DataFormat
	* Javel（Editor(textarea), text, blob, file）
	* HTML（Viewer(div), text, blob, file）
	* Element（Javel, HTML）
* RASIS（ラシス。ソフトウェア品質の評価指標）
	* 信頼性（Reliability。故障し難さ）
	* 可用性（Availability。稼働率（障害などで停止せず稼働し続ける時間））
	* 保守性（Serviceability。修理のし易さ）
	* 保全性（Integrity。復旧率（バックアップ））
	* 安全性（Security。セキュリティの高さ）
* 可搬性（portability。他環境への移行のし易さ）は？
* ISO 25010 ソフトウエア品質特性
	* https://www.skygroup.jp/software/quality/article/01/
	* https://qiita.com/mmake/items/ca97c616af0762a5164d
		* https://qiita.com/mmake/items/57900605a6d9f2cec3bc
		* https://qiita.com/mmake/items/1c4a14dc885a44ce6f38
* ISO 25010 ソフトウエア品質特性
	* 利用時品質（User Quality）
		* 有効性（設定された目標や要件をどれだけ効果的に達成できるか）Effectiveness
		* 効率性（リソースをどれだけ効率的に利用できるか）Efficiency
		* 満足性（ユーザーがどれだけ満足しているか）Satisfaction
			* 実用性（ユーザーにとって実用的であり、役立つか）Usefulness
			* 信用性（ユーザーに信頼感を与え、期待通りに動作できるか）Trust
			* 快感性（ユーザーに楽しさや満足感をもたらすか）Pleasure
			* 快適性（ユーザーに快適な体験をもたらすか）Comfort
		* リスク回避性（ソフトウェアが予測可能で潜在的なリスクを最小限に抑えるか）Freedom from risk
			* 経済リスク緩和性（ソフトウェアの利用がビジネスや経済においてリスクを軽減するか）Economic risk mitigation
			* 健康・安全リスク緩和性（ソフトウェアを使用することで生じる健康や安全に関するリスクを軽減するか）Health and safety risk mitigation
			* 環境リスク緩和性（ソフトウェアが環境に対して与えるリスクを軽減するか）Environmental risk mitigation
		* 利用状況網羅性（異なる状況や環境でどれだけ対応できるか）Context coverage
			* 利用状況完全性（異なる状況や文脈でどれだけ適応できるか）Context completeness
			* 柔軟性（柔軟に拡張や変更ができるか）Flexibility
	* 製品品質（開発時品質）Product Quality
		* 機能適合性（提供する機能がユーザーのニーズや期待にどれだけ適しているか）Functional Suitability
			* 機能完全性（必要な機能を十分に提供しているか）Functional Completeness
			* 機能正確性（提供する機能が期待通りに正確に動作するか）Functional Correctness
			* 機能適切性（利用者のニーズに適しているか）Functional Appropriateness
		* 性能効率性（リソースの使用を最適化し、高い性能を維持できるか）Performance Efficiency
			* 時間効率性（実行する機能が所定の時間内にどれだけ速く実行できるか）Time behaviour
			* 資源効率性（システムリソース（CPU、メモリ）を効果的に利用しているか）Resource utilization
			* 容量満足性（処理できるデータやユーザーの数に対する容量を評価）Capacity
		* 互換性（他のシステムやプラットフォームとどれだけ連携できるか）Compatibility
			* 共存性（他のソフトウェアと共存し、干渉なく使用できるか）Co-existence
			* 相互運用性（他のシステムやプラットフォームと効果的に連携できるか）Interoperability
		* 使用性（ユーザーにとってどれだけ使いやすいか）Usability
			* 適切度認識性（利用者の期待に適切に応え、理解しやすいか）Appropriateness recognizability
			* 習得性（初めて使うユーザーがどれだけ早く理解して使いこなせるか）Learnability
			* 適用操作性（正確な操作を提供し、ユーザーが簡単に操作できるか）Operability
			* ユーザエラー防止性（ユーザーの誤操作を防ぎ、誤って行った場合でも影響を最小限に抑えるか）User error protection
			* ユーザインタフェース快美性（ユーザーインターフェースが美的で魅力的か）User interface aesthetics
			* アクセシビリティ（身体障害者を含む全ての人が利用しやすいか）Accessibility
		* 信頼性（安定して動作し、障害やエラーが発生しづらいこと）Reliability
			* 成熟性（どれだけ安定しており、問題なく動作するか）Maturity
			* 可用性（必要な時に利用可能であるか）Availability
			* 障害許容性（耐障害性。障害やエラーに対してどれだけ耐性があるか）Fault tolerance
			* 回復性（障害から迅速に回復できるか）Recoverability
		* 安全性（データや利用者の情報を保護し、権限のないアクセスから守ること）Security
			* 機密性（データや情報をどれだけ機密に保護できるか）Confidentiality
			* 保全性（データや情報を正確に保ち、改ざんを防げるか）Integrity
			* 否認防止性（ユーザーが行ったアクションや取引を否認できないように保護するか）Non-repudiation
			* 責任追跡性（誰が何を行ったかをトレースできるか）Accountability
			* 真正性（ソフトウェアが本物で信頼性があり、名前の盗用を防げるか）Authenticity
		* 保守性（変更や修正を容易に受け入れ、保守作業がスムーズに行えること）Maintainability
			* モジュール性（構成要素が独立しており、変更や修正が容易か）Modularity
			* 再利用性（他のシステムで再利用できるか）Reusability
			* 解析性（障害の監視やログ取得が容易か）Analysability
			* 修正性（変更や修正が容易か）Modifiability
			* 試験性（試験が容易に行えるか）Testability
		* 移植性（異なる環境やプラットフォームで簡単に移植できること）Portability
			* 適応性（異なる環境や要件に適応できるか）Adaptability
			* 設置性（インストールが容易か）Installability
			* 置換性（新しいバージョンに簡単に置き換えられるか）Replaceability

No|要約|概要
--|----|----
1|機能適合性|実装された機能がユーザーのニーズをどれほど満たせているかを示す指標。あらかじめ明確にされている要望のみならず、潜在的なニーズもくみ取る必要がある。
2|性能効率性|システム実行時の性能や資源効率が適切かを示す指標。コンピュータで言えば、CPUの性能やメモリ・ストレージの容量に関係する。より省エネルギーで高性能な状態が望ましい。
3|互換性|別の動作環境でも支障なく機能を維持できるかを示す指標。例えばモバイルアプリなら、さまざまな機種のスマートフォンからアクセスしても適切に動作することを意味する。
4|使用性|どれだけ効果的・効率的に利用できるかを示す指標。例えばECサイトなら、商品の検索や注文が、年齢や性別を問わず直感的かつスムーズに操作できる状態を指す。
5|信頼性|システム障害の発生率の低さや、障害が発生した際の復旧のスムーズさといった、必要時に利用できるかを示す指標。特に利用頻度が高いシステムほど求められる。
6|セキュリティ|適切な利用者以外による「不正利用がない状況」の実現度合いを示す指標。例えば銀行のATMなど、個人情報や金銭が絡むシステムにおいて重要。
7|保守性|不具合要因の速やかな特定と復旧が可能か、日頃のメンテナンスが容易かを示す指標。異常が起きた時にも、ユーザーが安心して使い続けるために大切な観点。
8.移植性	ほかの動作環境への移植のしやすさを示す指標。例えばパソコンの最新OSにすぐ対応できるかが該当する。そのまま使うことを指す「互換性」と異なり、移植作業に伴う手の加えやすさが前提。


# 出力

* Javel（text, blob, file）
* HTML（text, blob, file）
* Element（Javel, HTML）

* Javel→HTML→TextArea
* HTML→Javel→TextArea
* Javel→HTML→ファイル
* HTML→Javel→ファイル


* テキスト／ファイル
* 動的／静的
* CUI／GUI
* Javel／HTML

* Webエディタ／Webツール／WebAPI／CUIツール


# 工程

　入力形式Javelと出力形式HTMLをそれぞれどうまとめるか。

* 読書
	* 1記事（表題＋本文（4000字程度迄））
	* シリーズ（表題＋目次＋複数記事（2〜8程度迄（8000〜32000字）））
	* 本（表紙／裏表紙、前書／後書、謝辞、目次、索引、扉、ノンブル（ページ）、柱）
	* 棚（DB(SQLite3)、検索、絞込）
* 著作
	* 紙片（1記事（表題＋本文＋日時＋カテゴリ＋ジャンル））
	* バインダー（表題＋複数紙片）
	* 製本
	* DB化
* 印刷
	* プリンタ（家庭用／コンビニ。CSS／PDF化）
* 宣伝
	* サイト（作品本体。オフライン読書可。Javel・HTML・EPub形式DL可。最新情報提供（RSS/Atom）。ライブラリ提供）
	* SNS（公式（最新情報提供）、作品紹介）
	* 画集（内容の抽象化ダイアグラム、内容を視覚化した一例、画像に作成した素材（GIMP形式,png,3Dモデル等））
	* 音声（読み上げ等）
	* 動画
* 返事（拡散、指摘、感想、意見、評価、二次創作）
	* 指摘（誤字・脱字・衍字・誤記・誤用・名前ミス・順序不正・コピペミス・他）
	* 提案（方言→標準語、ルビ振りや記法、圏点付与や記法）
	* 感想（対象（著者、作品、編、章、節、文）、保存方法（ローカル、SNS、GitHub）、形式（ブラウザ、SQLite3、File））
	* 意見（同上）
	* 評価（同上。区別・差別（区分・差分）・序列化（評価項目、評価根拠、評価日時、評価者、評価対象））
	* 拡散（RePost（著者の作品紹介発言をそのまま自分のアカウントで再発信する）、感想・意見・評価（作品URLを掲載して感想・意見・評価する））
	* 二次創作




```javascript
    /*
    const {h1, p, a} = van.tags
    const author = 'ytyaru'
    van.add(document.querySelector('main'), 
        h1(a({href:`https://github.com/${author}/Html.VanJS.Javel.Parser.20240524100007/`}, 'Javel.Parser')),
        p('Javel構文のパーサ。'),
//        p('Parser for Javel syntax.'),
    )
    van.add(document.querySelector('footer'),  new Footer('ytyaru', '../').make())
    */
    /*
    const parser = new JavelParser()
    console.log(parser)
    const manuscript = `# これは原稿《げんこう》です

　《《ここ》》に書いたテキストは下に表示《ひょうじ》されます。｜H《Hyper》｜T《Text》｜M《Markup》｜L《Language》形式で出力します。

　２つ以上の連続改行があると次の段落になります。
　１つだけの改行だと段落内改行です。

　
　全角スペースだけの段落なら連続した空行を表現できます。お勧めはしません。

　行頭インデントは全角スペースで書きます。

「セリフなど鉤括弧があるときはインデントしないよ」

――そのとき、神風が吹いた`
    const elements = parser.parse(manuscript)
    console.log(elements)
    for (el of elements) { console.log(el.outerHTML) }
    van.add(document.querySelector('main'), elements)
    */
```



* コンピュータ（PC/スマホ）利用者が無料で小説を書いて読める
* 他システムと連携できる
	* 作品を公開できる（GitHub）
	* 作品に感想・意見できる（Mastodon）
	* 作品を評価・紹介できる（Mastodon）
	* 作品をDLして保存・再読・編集・変換できる（Javel, HTML/CSS/JS, EPub, Markdown, Python）
	* 作品をプリンタで印刷して製本できる（）
	* 著者は読者から暗号通貨による寄付を受け取れる（Mona, BTC, ...）
* 他システムに組み込む
	* Software
		* WebApp
		* WebUi
		* WebApi
		* Library（CDN）
		* Library（File）
	* License
		* CC0, AGPL, ...
* 自サーバを立てる
	* 中央集権
		* 作品を検索・絞込・一覧できる（著者自身による作品公開サイト）
		* 著者を検索・絞込・一覧できる（複数著者による小説投稿サイト）
	* 分散
		* 連合化（Fediverse、ActivityPub、Webfinger。各個人が個別に管理しながらも相互に接続できる）
			* 自前でサーバをもち、他のサーバと連動して情報交換する（自他の作業を互いに通知し合える）
				* [自分／Ａ氏]はこの作品を公開しました
				* [自分／Ａ氏]はこの作品の作業中です
			* P2P共有（自他の作業履歴（成果）を互いに保存し合う）
				* 認知しあえる（読み合える。刺激し合える）
			* 特定サーバに集中して投稿＆DL
				* GitHubに各自投稿
				* 興味ある人物や作品を見つけてフォローすると以降はローカルでその情報を抽出する
				* 未フォローの人物や作品が投稿されたらPush通知を受け取る
					* 他人の数は最大八十億人で作業時間は24時間なので意識していると自分の時間が奪われる
						* 表示頻度はどうすべきか（常時ポップアップされてもウザい）
						* 保存頻度はどうすべきか（常時書き込まれたらディスクが死ぬ）
							* ノードのURLなど最低限の情報のみ保存する
							* それ以外のリアルタイム情報はすべてメモリ上にのみ保存する
								* 古い順に次々と捨てる

# 最終形式

* File
	* Javel（単一／分割）
	* 単一HTML
	* HTML/CSS/JS
	* SQLite3
	* EPub（XHTML）
	* PDF
	* Markdown
* App
	* ブラウザ
		* PWA（ローカルサーバ、GitHubPages）
		* Python（Eel）
		* 拡張機能（Chrome）
	* OS
		* GUI（Qt,GTK,wxWidgets,Tkinter）
		* 端末（CUI/TUI）
* Cmd（HTTPS REST, 端末（CUI/CLI））
* Lib（JavaScript, CDN, Python）

## App

## Lib

Lib|要約
---|----
Viewer|Javel形式のテキストデータかファイルURLを渡すと作品をHTML表示する

## WebApp機能

機能|要約
----|----
Editor|テキスト編集UI
Viewer|HTML表示UI
Generator|アプリの設定・入出力

* File系
	* 字数カウンタ
	* 出力
		* 形式（ファイル／クリップボード／UI／ポスト情報（WebAPI(HTTPS-POST)/BlueTooth））
		* 書式
			* Javel
			* HTML（動的／静的、単一／複数、リフロー／フィックス、本文のみ／文書全体（`<meta>`等））
			* SQLite3
			* EPub
			* PDF
			* ブラウザ（IndexedDB, LocalStorage）
		* 宛先
			* ローカル
			* サーバ（WebAPI）
			* 他デバイス（BlueTooth）
	* メタ情報編集（タイトル、カテゴリ、ジャンル、キャッチコピー、導入文、著者（名前、暗号通貨アドレス、SNS））
* Editor系
	* スクロール連動（Editor/Viewer）
	* Lint（禁則処理（「」の最後で句読点禁止））
	* 白黒
	* 縦横
	* ルビ（表示／非表示）
	* 圏点（表示／非表示、変更（マーク文字種、色））
	* 余白（字間、行間、余白）
	* 字形（フォント種別変更、フォントサイズ変更（一行あたりの読みやすい字数40字考慮））

